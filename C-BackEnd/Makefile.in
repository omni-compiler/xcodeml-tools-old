.PHONY: all clean install

JAVAC     = @JAVAC@
JAR       = @JAR@
JAVADIR   = @OMNI_HOME@/share/xcalablemp
MKDIR_P   = @MKDIR_P@
INSTALL   = @INSTALL@
OM_C_BACK = build/om-c-back.jar
SOURCE    = $(wildcard src/xcodeml/c/*/*.java)

all: $(OM_C_BACK)
$(OM_C_BACK): $(SOURCE) ../XcodeML-Common/build/om-common.jar
	$(JAVAC) -encoding utf8 src/xcodeml/c/*/*.java -classpath ../XcodeML-Common/build/om-common.jar:./src -Xlint:deprecation
	$(MKDIR_P) build
	cd src; $(JAR) cf ../$@ xcodeml/c/*/*.class

clean:
	rm -f $(OM_C_BACK) src/xcodeml/c/*/*.class

install: $(OM_C_BACK)
	$(MKDIR_P) $(JAVADIR)
	$(INSTALL) $^ $(JAVADIR)

